{% extends 'bertapp/base.html' %}
{% block title %}登録{% endblock %}
{% block content %}
<h1>{{ theme }}</h1>
<ul id="outputList"></ul>
<input type="text" id="messageInput" placeholder="Type a message...">
<button onclick="sendMessage()">Send</button>
<input type="text" id="answerInput" placeholder="Type a answer...">
<button onclick="sendAnswer()">Send</button>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    const socket = io();

    function sendMessage() {
        const message = document.getElementById('messageInput').value;
        socket.emit('send_message', { message: message });
        $('#messageInput').val('');
    }

    function sendAnswer() {
        const answer = document.getElementById('answerInput').value;
        socket.emit('send_answer', { answer: answer });
        $('#answerInput').val('');
    }

    socket.on('receive_message', function(data) {
        const liMessage = document.createElement('li');
        liMessage.innerText = `${data.message}`;
        document.getElementById('outputList').appendChild(liMessage);
        const liResponse= document.createElement('li');
        liResponse.innerText = `${data.response}`;
        document.getElementById('outputList').appendChild(liResponse);
    });

    socket.on('receive_result', function(data) {
        const liAnswer = document.createElement('li');
        liAnswer.innerText = `${data.answer}`;
        document.getElementById('outputList').appendChild(liAnswer);
        const liAnswerRes = document.createElement('li');
        liAnswerRes.innerText = `${data.result}`;
        document.getElementById('outputList').appendChild(liAnswerRes);
    });
</script>
{% endblock %}